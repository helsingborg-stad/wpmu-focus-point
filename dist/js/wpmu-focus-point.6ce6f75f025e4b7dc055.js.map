{"version":3,"file":"js/wpmu-focus-point.6ce6f75f025e4b7dc055.js","mappings":"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","sources":["webpack:///./js/wpmu-focus-point.ts","webpack:///./js/main.ts","webpack:///webpack/bootstrap","webpack:///webpack/startup"],"sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst main_1 = __importDefault(require(\"./main\"));\nconst focusAttribute = \"data-js-focus-axis\";\n// Init functionality after the DOM is loaded\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n    if (!wp || !wp.media || !wp.media.view || !wp.media.view.Modal) {\n        return;\n    }\n    wp.media.view.Modal.prototype.on(\"open\", () => {\n        setTimeout(() => {\n            const focusX = document.querySelector(`input[${focusAttribute}=\"x\"]`);\n            const focusY = document.querySelector(`input[${focusAttribute}=\"y\"]`);\n            const image = document.querySelector(`img.details-image:not(.icon)`);\n            if (image && focusX && focusY) {\n                const attachmentId = focusX.dataset.attachmentId;\n                const attachment = wp.media.attachment(attachmentId);\n                if (!checkAttachment(attachment)) {\n                    return;\n                }\n                new main_1.default(image, focusX, focusY);\n            }\n        }, 300);\n    });\n});\n// Check that the attachment is an image and not an SVG\nconst checkAttachment = (attachment) => {\n    return (!!attachment &&\n        !!attachment.get('mime') &&\n        attachment.get('mime').includes(\"image\") &&\n        !attachment.get('mime').includes(\"image/svg+xml\"));\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass Main {\n    constructor(image, focusX, focusY) {\n        Object.defineProperty(this, \"image\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: image\n        });\n        Object.defineProperty(this, \"focusX\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: focusX\n        });\n        Object.defineProperty(this, \"focusY\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: focusY\n        });\n        Object.defineProperty(this, \"defaultX\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 50\n        });\n        Object.defineProperty(this, \"defaultY\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: 50\n        });\n        if (image.complete) {\n            this.init();\n        }\n        else {\n            image.addEventListener(\"load\", () => {\n                this.init();\n            });\n        }\n    }\n    // Init functionality after image is loaded\n    init() {\n        const [container, imageWrapper, marker] = this.structureMarkup();\n        let xPercent = parseFloat(this.focusX.value) || this.defaultX;\n        let yPercent = parseFloat(this.focusY.value) || this.defaultY;\n        this.updateMarkerPosition(xPercent, yPercent, marker);\n        this.image.addEventListener(\"click\", (event) => {\n            const rect = this.image.getBoundingClientRect();\n            const percentX = (event.offsetX / rect.width) * 100;\n            const percentY = (event.offsetY / rect.height) * 100;\n            this.updateMarkerPosition(percentX, percentY, marker);\n            this.focusX.value = percentX.toFixed(2);\n            this.focusY.value = percentY.toFixed(2);\n            this.focusX.dispatchEvent(new Event(\"change\", { bubbles: true }));\n            this.focusY.dispatchEvent(new Event(\"change\", { bubbles: true }));\n        });\n    }\n    // Sets the markers position\n    updateMarkerPosition(xPercent, yPercent, marker) {\n        marker.style.left = `${xPercent}%`;\n        marker.style.top = `${yPercent}%`;\n    }\n    // Creates the markup and move elements to make functionality work\n    structureMarkup() {\n        const container = this.createDiv('wpmu-focus-point__container');\n        const imageWrapper = this.createDiv('wpmu-focus-point__image-wrapper');\n        const marker = this.createDiv('wpmu-focus-point__marker');\n        this.image.insertAdjacentElement(\"beforebegin\", container);\n        imageWrapper.appendChild(this.image);\n        container.appendChild(imageWrapper);\n        imageWrapper.appendChild(marker);\n        return [container, imageWrapper, marker];\n    }\n    createDiv(className) {\n        const div = document.createElement('div');\n        div.className = className;\n        return div;\n    }\n}\nexports.default = Main;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(235);\n"],"names":["__importDefault","this","mod","__esModule","Object","defineProperty","exports","value","main_1","focusAttribute","document","addEventListener","wp","media","view","Modal","prototype","on","setTimeout","focusX","querySelector","focusY","image","attachmentId","dataset","attachment","checkAttachment","default","get","includes","constructor","enumerable","configurable","writable","complete","init","container","imageWrapper","marker","structureMarkup","xPercent","parseFloat","defaultX","yPercent","defaultY","updateMarkerPosition","event","rect","getBoundingClientRect","percentX","offsetX","width","percentY","offsetY","height","toFixed","dispatchEvent","Event","bubbles","style","left","top","createDiv","insertAdjacentElement","appendChild","className","div","createElement","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","module","__webpack_modules__","call"],"ignoreList":[],"sourceRoot":""}